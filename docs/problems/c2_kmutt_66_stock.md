---
title: c2_kmutt_66_stock
---
# ข้อสอบท้ายค่าย 2 ปีการศึกษา 2566 ศูนย์ สอวน. มหาวิทยาลัยเทคโนโลยีพระจอมเกล้าธนบุรี ข้อ [Stock](https://grader.gchan.moe/problemset/c2_st66_stock/)
---
### Author: Nagorn Phongphasura
---

## Problem 

### สรุปโจทย์
มีวันอยู่ทั้งหมด $N$ วัน แต่ละวัน หุ้นจะมีราคา $P_i$ บาท ซีเค**สามารถซื้อขายหุ้นได้หลายรอบ แต่ใน 1 วันจะซื้อหรือขายได้เพียงรอบเดียว **(หรือไม่ซื้อขายหุ้นเลยก้ได้)

### สิ่งที่ต้องทำ
หากำไรที่มากที่สุดจากการซื้อขายหุ้น

!!! note "Constraints"
    $2 \leq N \leq 10^5$<br>
    $0 \leq P_1,P_2,...,P_N \leq 10^9$

!!! note "Prerequisites"
    - `Math`

---

## Solution

**Claim:** ผลรวมของกำไรที่มากที่สุดที่เป็นไปได้ เมื่อพิจารณาเพียงช่วง $[l,...,r]$ มีค่าเท่ากับ

\[
\sum_{i = l}^{r - 1} \max(0, p_{i + 1} - p_i)
\]

**Proof:** สมมติให้ลำดับการซื้อขายหุ้นที่จะทำให้ได้กำไรมากที่สุด คือการซื้อที่ตำแหน่ง $\{i_1, i_2, ..., i_k\}$ และขายที่ตำแหน่ง $\{j_1, j_2, ..., j_k\}$  

สำหรับแต่ละรอบการซื้อขาย \( (i_m, j_m) \) กำไรของรอบนั้นจะเป็น 

\[
p_{j_m} - p_{i_m} = (p_{i_m+1}-p_{i_m}) + (p_{i_m+2}-p_{i_m+1}) + \dots + (p_{j_m}-p_{j_m-1})
\]

ซึ่งเท่ากับ **ผลรวมของราคาที่เพิ่มขึ้น ในทุกๆคู่วัน**  

นอกจากนี้ ถ้าในวันไหนราคาลดลง การซื้อขายในวันนั้นจะทำให้ได้กำไร $\leq 0$ เราจึงไม่ควรขายหุ้นในวันนั้น<br> 
ดังนั้น กำไรที่สูงที่สุดที่เป็นไปได้ คือการรวมผลต่างของราคาในวันที่ราคาเพิ่มขึ้น (\(p_{i+1} - p_i > 0\))

จะได้ สูตรหากำไรที่สูงที่สุดในช่วง $[l, ..., r]$ เท่ากับ

\[
\sum_{i = l}^{r - 1} \max(0, p_{i + 1} - p_i)
\]

**ดังนั้น** วิธีทำโจทย์ข้อนี้ คือ Loop ตั้งแต่ 1 ถึง $N - 1$ แล้วในแต่ละรอบ เพิ่มค่าคำตอบไปด้วย $max(0, p_{i + 1} - p_i)$

---

## Code: 

```cpp title="c2_kmutt_66_stock.cpp"
#include <bits/stdc++.h>
#define int long long

using namespace std;

int32_t main() {
    cin.tie(NULL)->sync_with_stdio(false);

    // input
    int n;
    cin >> n;
    vector <int> p(n + 1);
    for (int i = 1; i <= n; i++) cin >> p[i];

    int ans = 0; // เก็บผลรวมคำตอบ

    // Loop เพื่อคำนวณ
    for (int i = 1; i < n; i++) {
        ans += max(0ll, p[i + 1] - p[i]);
    }

    // Output
    cout << ans << "\n";
    return 0;
}


```
!!! note "Total Time Complexity"
    $O(N)$
