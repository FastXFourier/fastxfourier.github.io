---
title: toi20_tour
tags: [TOI, Divide and Conquer, Geometry, Brute Force, Hard]
---
# ‡∏Ñ‡∏≥‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢‡∏ß‡∏¥‡∏ò‡∏µ‡∏ó‡∏≥‡∏û‡∏£‡πâ‡∏≠‡∏° code ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Ç‡πâ‡∏≠ [toi20_tour](https://api.otog.in.th/problem/doc/1017)

---

## Problem

### ‡∏™‡∏£‡∏∏‡∏õ‡πÇ‡∏à‡∏ó‡∏¢‡πå

‡∏°‡∏µ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÇ‡∏ã‡∏ô‡∏£‡πâ‡∏≤‡∏ô‡∏Ñ‡πâ‡∏≤ ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î $L$ ‡πÇ‡∏ã‡∏ô ‡πÅ‡∏ï‡πà‡∏•‡∏∞‡πÇ‡∏ã‡∏ô‡∏à‡∏∞‡∏°‡∏µ‡∏£‡πâ‡∏≤‡∏ô‡∏Ñ‡πâ‡∏≤ $N_i$ ‡∏£‡πâ‡∏≤‡∏ô ‡πÅ‡∏ï‡πà‡∏•‡∏∞‡∏£‡πâ‡∏≤‡∏ô‡∏à‡∏∞‡∏°‡∏µ‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡πÅ‡∏Ñ‡πà $1$ ‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó ‡πÄ‡∏õ‡πá‡∏ô ‚Äú‡∏ï‡∏∏‡πä‡∏Å‡∏ï‡∏≤‡∏ô‡πâ‡∏≠‡∏á‡∏™‡πâ‡∏°‡πÇ‡∏≠‡∏´‡∏ß‡∏≤‡∏ô‚Äù ‡∏´‡∏£‡∏∑‡∏≠ ‚Äú‡∏ï‡∏∏‡πä‡∏Å‡∏ï‡∏≤‡∏ô‡πâ‡∏≠‡∏á‡∏Ç‡πâ‡∏≤‡∏ß‡∏™‡∏≤‡∏£‡∏Ç‡∏≤‡∏ß‚Äù
‡∏Å‡∏ï‡∏¥‡∏Å‡∏≤‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡πÅ‡∏Ç‡πà‡∏á‡∏Ç‡∏±‡∏ô‡∏Ç‡∏≠‡∏á‡∏Ñ‡πà‡∏π‡∏£‡∏±‡∏Å‡∏Ñ‡∏ô‡πÅ‡∏£‡∏Å‡∏à‡∏∞‡πÄ‡∏£‡∏¥‡πà‡∏° shopping ‡∏à‡∏≤‡∏Å‡∏£‡πâ‡∏≤‡∏ô‡∏Ñ‡πâ‡∏≤‡∏ó‡∏µ‡πà $1$ ‡∏ã‡∏∂‡πà‡∏á‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏ô‡πÇ‡∏ã‡∏ô‡∏ó‡∏µ‡πà $1$ ‡∏à‡∏≤‡∏Å‡∏ô‡∏±‡πâ‡∏ô ‡∏à‡∏∞‡πÑ‡∏õ shopping ‡∏ï‡πà‡∏≠‡πÑ‡∏õ‡∏¢‡∏±‡∏á‡∏£‡πâ‡∏≤‡∏ô‡∏Ñ‡πâ‡∏≤‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏ô‡πÇ‡∏ã‡∏ô‡∏ñ‡∏±‡∏î‡πÑ‡∏õ (‡πÇ‡∏ã‡∏ô‡∏ó‡∏µ‡πà $2$) ‡πÄ‡∏û‡∏µ‡∏¢‡∏á $1$ ‡∏£‡πâ‡∏≤‡∏ô‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô (‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÄ‡∏Ç‡πâ‡∏≤ shopping ‡πÑ‡∏î‡πâ‡πÄ‡∏û‡∏µ‡∏¢‡∏á $1$ ‡∏£‡πâ‡∏≤‡∏ô‡∏ï‡πà‡∏≠ $1$ ‡πÇ‡∏ã‡∏ô‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô) ‡∏à‡∏≤‡∏Å‡∏ô‡∏±‡πâ‡∏ô‡∏à‡∏∞‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏î‡∏¥‡∏ô‡∏ó‡∏≤‡∏á‡∏à‡∏≤‡∏Å‡∏£‡πâ‡∏≤‡∏ô‡∏î‡∏±‡∏á‡∏Å‡∏•‡πà‡∏≤‡∏ß‡πÑ‡∏õ shopping ‡∏¢‡∏±‡∏á‡∏£‡πâ‡∏≤‡∏ô‡∏ñ‡∏±‡∏î‡πÑ‡∏õ‡πÉ‡∏ô‡πÇ‡∏ã‡∏ô‡∏ñ‡∏±‡∏î‡πÑ‡∏õ‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏¢‡πÜ ‡∏à‡∏ô‡∏Å‡∏ß‡πà‡∏≤‡∏à‡∏∞‡∏ñ‡∏∂‡∏á‡∏£‡πâ‡∏≤‡∏ô‡∏Ñ‡πâ‡∏≤‡∏™‡∏∏‡∏î‡∏ó‡πâ‡∏≤‡∏¢‡πÉ‡∏ô‡πÇ‡∏ã‡∏ô‡∏ó‡∏µ‡πà $L$ ‡πÇ‡∏î‡∏¢‡∏Å‡∏≤‡∏£ shopping ‡∏à‡∏∞‡∏ï‡πâ‡∏≠‡∏á shopping ‡∏†‡∏≤‡∏¢‡πÉ‡∏ï‡πâ‡πÄ‡∏™‡πâ‡∏ô‡∏ó‡∏≤‡∏á‡∏ó‡∏µ‡πà‡∏à‡∏±‡∏î‡∏™‡∏£‡∏£‡πÉ‡∏´‡πâ‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô
‡∏Ñ‡∏π‡πà‡∏£‡∏±‡∏Å‡∏ó‡∏µ‡πà‡∏à‡∏∞‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡πÅ‡∏Ç‡πà‡∏á‡∏Ç‡∏±‡∏ô shopping ‡πÉ‡∏ô‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡∏ô‡∏µ‡πâ‡∏Ñ‡∏∑‡∏≠‡∏Ñ‡πà‡∏π‡∏£‡∏±‡∏Å‡∏ó‡∏µ‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏ó‡πç‡∏≤‡πÉ‡∏´‡πâ‡∏Ñ‡πà‡∏≤‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ï‡πà‡∏≤‡∏á‡πÉ‡∏à $D = (F ‚àí F‚Ä≤)^2 + (G ‚àí G‚Ä≤)^2$

($F =$ ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ï‡∏∏‡πä‡∏Å‡∏ï‡∏≤‡∏ô‡πâ‡∏≠‡∏á‡∏™‡πâ‡∏°‡πÇ‡∏≠‡∏´‡∏ß‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡∏Ñ‡∏π‡πà‡∏£‡∏±‡∏Å‡∏Ñ‡∏ô‡πÅ‡∏£‡∏Å‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡∏°‡∏≤, $F‚Ä≤ =$ ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ï‡∏∏‡πä‡∏Å‡∏ï‡∏≤‡∏ô‡πâ‡∏≠‡∏á‡∏™‡πâ‡∏°‡πÇ‡∏≠‡∏´‡∏ß‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡∏Ñ‡∏π‡πà‡∏£‡∏±‡∏Å‡∏Ñ‡∏ô‡∏ó‡∏µ‡πà‡∏™‡∏≠‡∏á‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡∏°‡∏≤, $S =$ ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ï‡∏∏‡πä‡∏Å‡∏ï‡∏≤‡∏ô‡πâ‡∏≠‡∏á‡∏Ç‡πâ‡∏≤‡∏ß‡∏™‡∏≤‡∏£‡∏Ç‡∏≤‡∏ß‡∏ó‡∏µ‡πà‡∏Ñ‡∏π‡πà‡∏£‡∏±‡∏Å‡∏Ñ‡∏ô‡πÅ‡∏£‡∏Å‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡∏°‡∏≤, $S‚Ä≤ =$ ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ï‡∏∏‡πä‡∏Å‡∏ï‡∏≤‡∏ô‡πâ‡∏≠‡∏á‡∏Ç‡πâ‡∏≤‡∏ß‡∏™‡∏≤‡∏£‡∏Ç‡∏≤‡∏ß‡∏ó‡∏µ‡πà‡∏Ñ‡∏π‡πà‡∏£‡∏±‡∏Å‡∏Ñ‡∏ô‡∏ó‡∏µ‡πà‡∏™‡∏≠‡∏á‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡∏°‡∏≤)

‡∏°‡∏µ‡∏Ñ‡πà‡∏≤‡∏ó‡∏µ‡πà‡∏ô‡πâ‡∏≠‡∏¢‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î ‡πÄ‡∏û‡∏£‡∏≤‡∏∞‡∏ñ‡∏∑‡∏≠‡∏ß‡πà‡∏≤‡∏Ñ‡πà‡∏π‡∏£‡∏±‡∏Å‡∏ó‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏π‡∏°‡∏µ‡πÉ‡∏à‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ô‡∏°‡∏≤‡∏Å ‡πÅ‡∏ï‡πà‡∏≠‡∏¢‡πà‡∏≤‡∏á‡πÑ‡∏£‡∏Å‡πá‡∏ï‡∏≤‡∏°‡∏´‡∏≤‡∏Å‡∏Ñ‡πà‡∏≤‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ï‡πà‡∏≤‡∏á‡πÉ‡∏à‡∏î‡∏±‡∏á‡∏Å‡∏•‡πà‡∏≤‡∏ß‡∏°‡∏µ‡∏Ñ‡πà‡∏≤‡πÄ‡∏õ‡πá‡∏ô 0 ‡∏Å‡∏£‡∏£‡∏°‡∏Å‡∏≤‡∏£‡∏à‡∏∞‡∏ó‡πç‡∏≤‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡πÄ‡∏™‡πâ‡∏ô‡∏ó‡∏≤‡∏á shopping ‡∏Ç‡∏≠‡∏á‡∏Ñ‡πà‡∏π‡∏£‡∏±‡∏Å‡∏ó‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏π ‡∏´‡∏≤‡∏Å‡∏û‡∏ö‡∏ß‡πà‡∏≤ ‡∏Ñ‡πà‡∏π‡∏£‡∏±‡∏Å‡∏ó‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏π‡πÉ‡∏ä‡πâ‡πÄ‡∏™‡πâ‡∏ô‡∏ó‡∏≤‡∏á‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö‡πÄ‡∏î‡∏µ‡∏¢‡∏ß‡∏Å‡∏±‡∏ô $100$% ‡πÉ‡∏ô‡∏Å‡∏≤‡∏£ shopping ‡∏Å‡∏≤‡∏£‡πÅ‡∏Ç‡πà‡∏á‡∏Ç‡∏±‡∏ô‡∏î‡∏±‡∏á‡∏Å‡∏•‡πà‡∏≤‡∏ß‡∏ñ‡∏∑‡∏≠‡∏ß‡πà‡∏≤‡πÑ‡∏°‡πà‡∏™‡∏∏‡∏à‡∏£‡∏¥‡∏ï ‡πÅ‡∏•‡∏∞‡∏à‡∏∞‡πÑ‡∏°‡πà‡∏≠‡∏ô‡∏∏‡∏ç‡∏≤‡∏ï‡πÉ‡∏´‡πâ‡∏£‡∏±‡∏ö‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•‡πÉ‡∏ô‡∏Å‡∏£‡∏ì‡∏µ‡∏ô‡∏µ‡πâ


### ‡∏™‡∏¥‡πà‡∏á‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏ó‡∏≥

‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô‡πÇ‡∏Ñ‡πâ‡∏î‡∏ó‡∏µ‡πà‡∏à‡∏∞‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏ß‡πà‡∏≤ ‡∏Ñ‡πà‡∏≤‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ï‡πà‡∏≤‡∏á‡πÉ‡∏à‡∏ó‡∏µ‡πà‡∏ô‡πâ‡∏≠‡∏¢‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î‡∏à‡∏∞‡∏°‡∏µ‡∏Ñ‡πà‡∏≤‡πÄ‡∏ó‡πà‡∏≤‡πÉ‡∏î

!!! note "Constraints"
    $N$ ‡∏´‡∏°‡∏≤‡∏¢‡∏ñ‡∏∂‡∏á ‡∏à‡πç‡∏≤‡∏ô‡∏ß‡∏ô‡∏£‡πâ‡∏≤‡∏ô‡∏Ñ‡πâ‡∏≤‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î ‡πÅ‡∏•‡∏∞ $4\leq N\leq 200,000$<br>
    $M$ ‡∏´‡∏°‡∏≤‡∏¢‡∏ñ‡∏∂‡∏á ‡∏à‡πç‡∏≤‡∏ô‡∏ß‡∏ô‡πÄ‡∏™‡πâ‡∏ô‡∏ó‡∏≤‡∏á ‡πÅ‡∏•‡∏∞ $3\leq M\leq 300,000$<br>
    $L$ ‡∏´‡∏°‡∏≤‡∏¢‡∏ñ‡∏∂‡∏á ‡∏à‡πç‡∏≤‡∏ô‡∏ß‡∏ô‡πÇ‡∏ã‡∏ô ‡πÅ‡∏•‡∏∞ $3\leq L\leq 10$<br>
    $n_i$ ‡∏´‡∏°‡∏≤‡∏¢‡∏ñ‡∏∂‡∏á ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏£‡πâ‡∏≤‡∏ô‡πÉ‡∏ô‡πÅ‡∏ï‡πà‡∏•‡∏∞‡πÇ‡∏ã‡∏ô ‡πÅ‡∏•‡∏∞
    - $\sum_{i=1}^{L} n_i=N$
    - $\prod_{i=1}^{L} n_i \leq 10^6$
    - $n_1=n_L=1$
      

!!! note "Prerequisites"
    - `Closest pair of points Algorithm`

---

## Solution

### ‡∏Ç‡πâ‡∏≠‡∏™‡∏±‡∏á‡πÄ‡∏Å‡∏ï

- $\prod_{i=1}^{L} n_i \leq 10^6$
- ‡∏™‡∏π‡∏ï‡∏£‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì ‚Äú‡∏Ñ‡πà‡∏≤‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ï‡πà‡∏≤‡∏á‡πÉ‡∏à‚Äù: $D = (F ‚àí F‚Ä≤)^2 + (G ‚àí G‚Ä≤)^2$ ‡∏Ñ‡πà‡∏≠‡∏ô‡∏Ç‡πâ‡∏≤‡∏á‡∏Ñ‡∏•‡πâ‡∏≤‡∏¢‡∏Å‡∏±‡∏ö‡∏™‡∏π‡∏ï‡∏£‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì Euclidean Distance: $D=\sqrt{(x_2-x_1)^2+(y_2-y_1)^2}$

### ‡∏ß‡∏¥‡∏ò‡∏µ‡∏ó‡∏≥

‡πÄ‡∏£‡∏≤‡∏à‡∏∞‡∏ó‡∏≥‡∏Å‡∏≤‡∏£ Brute Force ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏´‡∏≤‡∏ó‡∏∏‡∏Å‡πÜ‡∏Ñ‡∏π‡πà‡∏≠‡∏±‡∏ô‡∏î‡∏±‡∏ö $(F,G)$ ‡∏ó‡∏µ‡πà‡πÄ‡∏õ‡πá‡∏ô‡πÑ‡∏õ‡πÑ‡∏î‡πâ (‡πÄ‡∏£‡∏≤‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏ó‡∏≥‡∏Å‡∏≤‡∏£ Brute Force ‡πÑ‡∏î‡πâ‡πÄ‡∏û‡∏£‡∏≤‡∏∞‡∏ß‡πà‡∏≤ ‡∏ú‡∏•‡∏Ñ‡∏π‡∏ì‡∏Ç‡∏≠‡∏á‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏£‡πâ‡∏≤‡∏ô‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡πÉ‡∏ô‡πÅ‡∏ï‡πà‡∏•‡∏∞‡πÇ‡∏ã‡∏ô ‡∏à‡∏∞‡∏°‡∏µ‡∏Ñ‡πà‡∏≤‡πÑ‡∏°‡πà‡πÄ‡∏Å‡∏¥‡∏ô $10^6$) ‡πÅ‡∏•‡∏∞‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÄ‡∏£‡∏≤‡∏´‡∏≤‡∏≠‡∏≠‡∏Å‡∏°‡∏≤‡πÅ‡∏•‡πâ‡∏ß ‡πÄ‡∏£‡∏≤‡∏à‡∏∞‡πÉ‡∏ä‡πâ‡∏≠‡∏±‡∏•‡∏Å‡∏≠‡∏£‡∏¥‡∏ó‡∏∂‡∏°‡∏ó‡∏µ‡πà‡∏ä‡∏∑‡πà‡∏≠‡∏ß‡πà‡∏≤ ‚ÄúClosest Pair of Points‚Äù ‡∏ã‡∏∂‡πà‡∏á‡∏à‡∏£‡∏¥‡∏á‡πÜ‡πÅ‡∏•‡πâ‡∏ß‡πÉ‡∏ä‡πâ‡∏´‡∏≤‡∏£‡∏∞‡∏¢‡∏∞‡∏ó‡∏µ‡πà‡∏™‡∏±‡πâ‡∏ô‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á‡∏à‡∏∏‡∏î‡∏™‡∏≠‡∏á‡∏à‡∏∏‡∏î ‡πÅ‡∏ï‡πà‡πÄ‡∏ô‡∏∑‡πà‡∏≠‡∏á‡∏à‡∏≤‡∏Å‡∏™‡∏π‡∏ï‡∏£‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏Ñ‡πà‡∏≤‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ï‡πà‡∏≤‡∏á‡πÉ‡∏à‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô‡∏Å‡∏±‡∏ö‡∏™‡∏π‡∏ï‡∏£‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì Euclidean Distance (‡∏ï‡πà‡∏≤‡∏á‡∏Å‡∏±‡∏ô‡πÅ‡∏Ñ‡πà‡∏™‡∏π‡∏ï‡∏£‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì Euclidean Distance ‡∏à‡∏∞‡∏°‡∏µ‡∏Å‡∏≤‡∏£‡πÉ‡∏™‡πà‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏´‡∏°‡∏≤‡∏¢ Square Root ($\sqrt{}$) ‡πÄ‡∏£‡∏≤‡∏à‡∏∂‡∏á‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÉ‡∏ä‡πâ‡∏≠‡∏±‡∏•‡∏Å‡∏≠‡∏£‡∏¥‡∏ó‡∏∂‡∏°‡∏î‡∏±‡∏á‡∏Å‡∏•‡πà‡∏≤‡∏ß‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏´‡∏≤‡∏Ñ‡∏π‡πà‡∏≠‡∏±‡∏ô‡∏î‡∏±‡∏ö $(F,G)$ 2 ‡∏Ñ‡∏π‡πà‡∏ó‡∏µ‡πà‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì ‚Äú‡∏Ñ‡πà‡∏≤‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ï‡πà‡∏≤‡∏á‡πÉ‡∏à‚Äù ‡∏≠‡∏≠‡∏Å‡∏°‡∏≤‡πÅ‡∏•‡πâ‡∏ß ‡∏à‡∏∞‡∏°‡∏µ‡∏Ñ‡πà‡∏≤‡∏ô‡πâ‡∏≠‡∏¢‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î

### Summary

- ‡πÉ‡∏ä‡πâ‡∏Å‡∏≤‡∏£ Brute Force ‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏´‡∏≤‡∏Ñ‡∏π‡πà‡∏≠‡∏±‡∏ô‡∏î‡∏±‡∏ö $(F,G)$ ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î
- ‡πÉ‡∏ä‡πâ‡∏≠‡∏±‡∏•‡∏Å‡∏≠‡∏£‡∏¥‡∏ó‡∏∂‡∏° Closest Pair of Points ‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏´‡∏≤ ‚Äú‡∏Ñ‡πà‡∏≤‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ï‡πà‡∏≤‡∏á‡πÉ‡∏à‚Äù ‡∏ó‡∏µ‡πà‡∏ô‡πâ‡∏≠‡∏¢‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î

---

## Code

```cpp
#include <bits/stdc++.h> 

#define int long long 

using namespace std; 

const int N = 1e1 + 5; 

int n, m, l, z[N]; 
vector <pair <int, int>> p; 
vector <tuple <int, int, int>> adj[200005]; 

void dfs(int u, int x, int y) { 
	for (auto [s, w, v] : adj[u]) { 
		if (v == n) { 
			p.emplace_back((s == 1 ? make_pair(x + w, y) : make_pair(x, y + w))); continue; 
		} 
		if (s == 1) dfs(v, x + w, y); 
		else dfs(v, x, y + w); 
	} 
} 
int dis(pair <int, int> a, pair <int, int> b) { // ‡πÉ‡∏ä‡πâ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì ‡∏Ñ‡πà‡∏≤‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ï‡πà‡∏≤‡∏á‡πÉ‡∏à / euclidean distance 
	return (a.first - b.first) * (a.first - b.first) + (a.second - b.second) * (a.second - b.second); 
} 

int cpop(int l, int r){ 
	if (r - l + 1 <= 3) { 
		int ans = 1e18; 
		for (int i = l; i < r; i++) { 
			for (int j = i + 1; j <= r; j++) { 
				ans = min(ans, dis(p[i], p[j])); 
			} 
		} 
		return ans; 
	} 
	int mid = (l + r) / 2; 
	int left = cpop(l, mid), right = cpop(mid, r); 
	int mn = min(left, right); 
	int xm = p[mid].first; 
	vector <pair <int, int>> pts; 
	for (int i = l; i <= r; i++) { 
		if ((p[i].first - xm) * (p[i].first - xm) < mn) pts.emplace_back(p[i]); 
	} 
	sort(pts.begin(), pts.end(), [](const pair <int, int> &a, const pair <int, int> &b){ 
		return a.second < b.second;
	}); 
	for (int i = 0; i < pts.size(); i++) { 
		for (int j = i + 1; j < pts.size() && dis(pts[i], pts[j]) < mn; j++) { 
			mn = min(mn, dis(pts[i], pts[j])); 
		} 
	} 
	return mn; 
} 

int32_t main(){ 
	cin.tie(NULL)->sync_with_stdio(false); // input 
	cin >> n >> m >> l; 
	for (int i = 1; i <= l; i++) cin >> z[i]; 
	for (int i = 1; i <= m; i++) { 
		int u, v, s, w; cin >> u >> v >> s >> w; 
		adj[u].emplace_back(s, w, v); 
	} 
	// brute force calculations 
	dfs(1, 0, 0); 
	// closest pair of points algorithm 
	sort(p.begin(), p.end()); 
	cout << cpop(0, p.size() - 1); 
}
```

!!! note "Total Time Complexity"
    ‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡πÉ‡∏´‡πâ $x=$ ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏Ñ‡∏π‡πà‡∏≠‡∏±‡∏ô‡∏î‡∏±‡∏ö $(F,G)$ ‡∏ó‡∏µ‡πà‡∏´‡∏≤‡∏≠‡∏≠‡∏Å‡∏°‡∏≤‡πÑ‡∏î‡πâ
    - Brute Force: $O(x)$
    - Closest Pair of Points: $O(x\log x)$
    - Total: $O(x+x\log x)=O(x\log x)$

‡∏´‡∏≤‡∏Å‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏™‡∏á‡∏™‡∏±‡∏¢ comment ‡πÑ‡∏ß‡πâ‡πÉ‡∏ï‡πâ post ‡πÑ‡∏î‡πâ‡πÄ‡∏•‡∏¢‡∏ô‡∏∞‡∏Ñ‡∏£‡∏±‡∏ö üôá‚Äç‚ôÇÔ∏èüôá‚Äç‚ôÇÔ∏è
‡∏®‡∏∂‡∏Å‡∏©‡∏≤‡πÇ‡∏à‡∏ó‡∏¢‡πå‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°‡πÑ‡∏î‡πâ‡∏ó‡∏µ‡πà [Fast X Fourier](https://fastxfourier.github.io/Home/)
